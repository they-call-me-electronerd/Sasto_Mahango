# ===========================================================================
# UPLOAD DIRECTORY PROTECTION
# ===========================================================================
# Place this file in /assets/uploads/items/
# Prevents PHP execution in upload directory
# ===========================================================================

# Deny access to PHP files
<FilesMatch "\.php$">
    Order deny,allow
    Deny from all
</FilesMatch>

# Only allow image files
<FilesMatch "\.(jpg|jpeg|png|gif|webp|svg)$">
    Order allow,deny
    Allow from all
</FilesMatch>

# Prevent directory listing
Options -Indexes

# Set proper MIME types
<IfModule mod_mime.c>
    AddType image/jpeg .jpg .jpeg
    AddType image/png .png
    AddType image/gif .gif
    AddType image/webp .webp
    AddType image/svg+xml .svg
</IfModule>

# Remove PHP handlers
RemoveHandler .php .phtml .php3 .php4 .php5 .phps .cgi .pl .py .jsp .asp .sh .cgi
RemoveType .php .phtml .php3 .php4 .php5 .phps .cgi .pl .py .jsp .asp .sh .cgi
